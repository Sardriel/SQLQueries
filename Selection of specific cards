  SELECT  Count(Userproviderkey) as pocetKaretNaUcet, email, number, DefaultCustomerProfiles.Name
  FROM [MyDatabase].[dbo].[Table] 
  JOIN  [MyDatabase].[dbo].[Table1] ON Table1.id = Table.UserProviderKey
  JOIN  [MyDatabase].[dbo].Table2 ON Table2.cardid = Table.id
  JOIN  [MyDatabase].[dbo].Table3 ON Table3.Id = Table2.CustomerProfileId
  WHERE 

  email in ('') and 

  Table.state NOT IN ( '7', '3', '2') and 
  Table.ExpirationUTC !< GETDATE() and 
  Table2.State = '2'
  
  
  
  
  -----and Table.Borndate > '2006-06-02 00:00:00.000'
  Group by email, number, Table3.Name  order by email 
